data:text/html,
<title>NIMBUS WEB v0.1.2</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/a-riceeater/DataCodeEditor@latest/atom.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<style>
  .l{position:fixed;left:0;top:0;width:30px;height:100%;background-color:rgb(40, 44, 52);color:white;text-align:center;font-size:14px;padding-top:5px;box-sizing:border-box;line-height:1em;overflow-y:scroll;cursor:default;font-family:Menlo,Monaco,'Courier New',monospace;border-right:1px solid lightgray}.c,.h{font-family:Menlo,Monaco,'Courier New',monospace;width:calc(100% - 30px);height:100%;position:fixed;left:30px;top:0;outline:0;font-size:14px;padding-top:2.5px;box-sizing:border-box;line-height:1em;border:none;padding-left:5px}.l::-webkit-scrollbar{display:none}.c{background-color:transparent;color:transparent;z-index:3;caret-color:lightgray}.c::selection{background-color:rgb(211,211,211,.35)}.h{background-color:rgb(40, 44, 52);color:lightgray;z-index:2;overflow-y: scroll}.cm{position:fixed;z-index:4;background-color:black;color:white;top:100px;left:100px;width:200px;height:30px;display:none;justify-content:center}.cm>div{display:flex;cursor:pointer;text-align:center;justify-content:center;width:100%;align-items:center;font-family:Menlo,Monaco,'Courier New',monospace;font-size:14px;margin-top:5px;margin-bottom:5px}.cm>div:hover{background-color:rgb(47, 114, 229);}
</style>
<div class="l"></div>
<pre><div class="h"></div></pre>
<textarea class="c" placeholder="CTRL+S: OPEN PAGE OUTPUT | CTRL+SHIFT+S: SAVE AS FILE" autofocus spellcheck="false" autocomplete="off" autocapitalize="false"></textarea>
<div class="cm">
    <div class="fm">Format Document</div>
</div>
<script>const d=t=>document.querySelector(t);var wl,cfh,lang="js",h=d(".h"),e=d(".c"),l=d(".l"),cm=d(".cm");async function gf(){try{let[t]=await window.showOpenFilePicker({types:[{description:"Text files",accept:{"text/*":".txt"}}],multiple:!1,excludeAcceptAllOption:!0});return cfh=t,await t.getFile()}catch(a){console.error(a),a.toString().includes("aborted")||alert("User must do an input (keypress/click) before opening dialog.")}}navigator.platform.toString().toLowerCase().includes("mac")?e.placeholder="META+S: OPEN PAGE OUTPUT | META+D: SAVE AS FILE":e.placeholder="CTRL+S: OPEN PAGE OUTPUT | CTRL+D: SAVE AS FILE",e.addEventListener("scroll",t=>{let a=t.target.scrollTop;h.scrollTop=a,l.scrollTop=a,h.scrollLeft=t.target.scrollLeft}),l.addEventListener("scroll",t=>{let a=t.target.scrollTop;h.scrollTop=a,e.scrollTop=a});const ins=(t,a)=>{let r=e.selectionStart,n=e.selectionEnd;if(e.value.charAt(r)==t){e.setSelectionRange(r+1,r+1),a.preventDefault();return}e.value=e.value.substring(0,r)+t+e.value.substring(n),e.selectionStart=e.selectionEnd=r+t.length-1,e.focus()},inb=(t,a)=>{var r=e.selectionStart;e.value.charAt(r)==t&&(e.setSelectionRange(r+1,r+1),a.preventDefault())},hl=()=>h.innerHTML=hljs.highlight(e.value,{language:lang}).value||e.value,fd=()=>{try{e.value=js_beautify(e.value,{indent_size:4}),hl()}catch(t){alert("Failed to format..."),console.error(t)}};e.addEventListener("keydown",async t=>{"Tab"==t.key&&t.preventDefault(),hl();try{if(t.ctrlKey&&"d"==t.key||t.metaKey&&"d"==t.key){t.preventDefault();let a=document.createElement("a");var r=prompt("file name? (with ext.)");if(!r)return;a.download=r,a.href=URL.createObjectURL(new Blob([e.value],{type:"text/plain"})),a.click()}else if(t.ctrlKey&&"s"==t.key||t.metaKey&&"s"==t.key){if(t.preventDefault(),cfh){console.log(cfh);var n=await cfh.createWritable();await n.write(new Blob([e.value],{type:"text/plain"})),await n.close()}else{wl&&wl.close();let c=window.open();c.document.write(e.value),wl=c}}else if(t.ctrlKey&&"p"==t.key||t.metaKey&&"p"==t.key)t.preventDefault(),fd();else if(t.ctrlKey&&"o"==t.key||t.metaKey&&"o"==t.key){t.preventDefault();let s=await gf();if(!s)return;lang=/(?:\.([^.]+))?$/.exec(s.name)[1],e.value=await s.text(),setTimeout(hl)}}catch(i){alert(i)}switch(t.key){case"Tab":ins("    ");break;case"{":ins("}",t);break;case"[":ins("]",t);break;case"(":ins(")",t);break;case'"':ins('"',t);break;case"'":ins("'",t);break;case"`":ins("`",t);case")":inb(")",t);break;case"}":inb("}",t);break;case"]":inb("]",t)}setTimeout(()=>{is(t.key),setTimeout(()=>{hl();let t=e.scrollTop;l.scrollTop=t,h.scrollTop=t,h.scrollLeft=e.scrollLeft;let a="",r=e.value.split("\n").length;for(let n=0;n<r;n++)a+=`${n+1}<br>`;l.innerHTML=a})})}),e.addEventListener("contextmenu",t=>{t.preventDefault(),cm.style.top=t.clientY,cm.style.left=t.clientX,cm.style.display="flex"}),e.addEventListener("click",t=>{cm.style.display="none"}),d(".fm").addEventListener("click",fd),String.prototype.replaceAt=function(t,a){return this.substring(0,t)+a+this.substring(t+a.length)};</script>
